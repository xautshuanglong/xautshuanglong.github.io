<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WinApiCollection 常用 Windows API | Shuanglong</title>
  <meta name="author" content="JiangShuanglong">
  
  <meta name="description" content="实用 API，封装成工具库，以免忘记。">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="WinApiCollection 常用 Windows API"/>
  <meta property="og:site_name" content="Shuanglong"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="//atom.xml" title="Shuanglong" type="application/atom+xml">
  
  
    <link href="/css/images/favicon.ico" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/cerulean.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  
    <script src="/js/marked.js"></script>
    <script src="/js/comment.js"></script>
    <script src="/js/timeago.min.js"></script>
    <script src="/js/highlight.min.js"></script>
	<script src="/js/spin.min.js"></script>
  
  <!-- analytics -->
  


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?cdbf45c160c2410580214c9a5a9b169c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<meta name="generator" content="Hexo 7.0.0-rc2"></head>

<body>
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Shuanglong</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About Shuanglong">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content">
      


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> WinApiCollection 常用 Windows API</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> <p>实用 API，封装成工具库，以免忘记。</p>
			
		 </div> <!-- alert -->
	  		

	  <blockquote>
<p>经典 Windows API 用法说明，值得收藏···</p>
</blockquote>
<span id="more"></span>

<h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><h4 id="CopyFile"><a href="#CopyFile" class="headerlink" title="CopyFile"></a>CopyFile</h4><pre><code>BOOL WINAPI CopyFile(
    _In_  LPCTSTR lpExistingFileName,
    _In_  LPCTSTR lpNewFileName,
    _In_  BOOL bFailIfExists
);
Copy an existing file to a new file.
lpExistingFileName[in] --&gt; The name of existing file.
lpNewFileName[in] --&gt; The name of new file.
bFailIfExists[in] --&gt; If this parameter is TRUE and the new file specified by lpNewFileName 
already exist, the function fails. If this parameter is FALSE and the new file already exists, 
the function overwrites the existing file andd succeeds.
</code></pre>
<h4 id="CreateDirectory"><a href="#CreateDirectory" class="headerlink" title="CreateDirectory"></a>CreateDirectory</h4><pre><code>BOOL CreateDirectory(
    LPCTSTR lpPathName,
    LPSECURITY_ATTRIBUTES lpSecurityAttributes 
);
This function creates a new directory. If the underlying file system supports security on files and 
directories, the function applies a specified security descriptor to the new directory.
lpPathName[in] --&gt; Long pointer to a null-terminated string that specified the path of the directory 
to be created.
lpSecurityAttributes[in] --&gt; Ignored; set to NULL.
</code></pre>
<h3 id="D"><a href="#D" class="headerlink" title="D"></a>D</h3><h4 id="DeleteFile"><a href="#DeleteFile" class="headerlink" title="DeleteFile"></a>DeleteFile</h4><pre><code>BOOL WINAPI DeleteFile(
    _In_ LPCTSTR lpFileName
);
Deletes an existing file.
lpFileName[in] --&gt; The name of file to be deleted.
</code></pre>
<h3 id="M"><a href="#M" class="headerlink" title="M"></a>M</h3><h4 id="MoveFile"><a href="#MoveFile" class="headerlink" title="MoveFile"></a>MoveFile</h4><pre><code>BOOL WINAPI MoveFile(
    _In_ LPCTSTR lpExistingFileName,
    _In_ LPCTSTR lpNewFileName
);
Moves an existing file or a directory, including its children.
lpExistingFileName[in] --&gt; The current name of the file or directory on the local computer.
lpNewFileName[in] --&gt; The new name for the file or directory. The new file must not already exist.
A new file may be on a different file system or drive. A new directory must be on the same drive. 
</code></pre>
<h3 id="R"><a href="#R" class="headerlink" title="R"></a>R</h3><h4 id="RemoveDirectory"><a href="#RemoveDirectory" class="headerlink" title="RemoveDirectory"></a>RemoveDirectory</h4><pre><code>BOOL RemoveDirectory(
    LPCTSTR lpPathName
);
This function detetes an empty directory.
lpPathName[in] --&gt; Pointer to a null-terminated string that specifies the path of the directory 
to be removed. The path must specify an empty directory, and the calling process must have delete 
access to the directory.
</code></pre>
<h4 id="ReOpenFile"><a href="#ReOpenFile" class="headerlink" title="ReOpenFile"></a>ReOpenFile</h4><pre><code>HANDLE WINAPI ReOpenFile(
    _In_  HANDLE hOriginalFile,
    _In_  DWORD dwDesiredAccess,
    _In_  DWORD dwShareMode,
    _In_  DWORD dwFlags
);
Reopens the specified file system object with different access rights, sharing mode, and flas.
hOriginalFile [in] --&gt; A handle to the object to be reopened. The object must have been created 
by the CreateFile function.
dwDesiredAccess [in] --&gt; The required access to the object. For a list of values, see File Security 
and Access Rights. You cannot request an access mode that conflicts with the sharing mode specified 
in a previous open request whose handle is still open.
If this parameter is zero (0), the application can query device attributes without accessing the device. 
This is useful if an application wants to determine the size of a floppy disk drive and the formats 
it supports without requiring a floppy in the drive.
dwShareMode [in] --&gt; The sharing mode of the object. You cannot request a sharing mode that 
conflicts with the access mode specified in a previous open request whose handle is still open.
If this parameter is zero (0) and CreateFile succeeds, the object cannot be shared and cannot be 
opened again until the handle is closed.
</code></pre>
	  
	</div>

	<!-- recommended posts -->
	

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2016/12/23/CPlusPlus/CPlusPlus禁止某些操作的技巧/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2016/11/27/CPlusPlus/const用法总结/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        
    <div class="bdsharebuttonbox">
        <a href="#" class="bds_more" data-cmd="more"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
        <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
        <a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
        <a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a>
        <a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a>
        <a href="#" class="bds_copy" data-cmd="copy" title="分享到复制网址"></a>
    </div>
    <script>
        window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{}};
        with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>


        

    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">留言</h2>
    	 
	 <div id="comment-thread"></div>
	 <div id="loading-spin"></div>
	 <script type="text/javascript">
	   getComments({
           type: "github" ? "github" : "github",       
	       user: "xautshuanglong",
	       repo: "xautshuanglong.github.io",
		   client_id: "9393dc785289a96d8026",
           client_secret: "e33339d6cbd320a707d655ee9b941a01c3c8ae28",
		   no_comment: "暂时还没有留言呢，点击下面的按钮去留言吧！",
		   go_to_comment: "去留言",
		   no_issue: "no_issue",
		   issue_title: "WinApiCollection 常用 Windows API",
		   issue_id: "",
		   btn_class: "btn btn-primary",
		   comments_target: "#comment-thread",
		   loading_target: "#loading_spin"
		   });
	 </script>
  
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2016-12-18 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/CPP/">CPP<span>21</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/API/">API<span>1</span></a></li>
    </ul>
	</div>
	

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
			<ol class="toc-article"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#C"><span class="toc-article-text">C</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#CopyFile"><span class="toc-article-text">CopyFile</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#CreateDirectory"><span class="toc-article-text">CreateDirectory</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#D"><span class="toc-article-text">D</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#DeleteFile"><span class="toc-article-text">DeleteFile</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#M"><span class="toc-article-text">M</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#MoveFile"><span class="toc-article-text">MoveFile</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#R"><span class="toc-article-text">R</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#RemoveDirectory"><span class="toc-article-text">RemoveDirectory</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#ReOpenFile"><span class="toc-article-text">ReOpenFile</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->



    </div>
  </div>
  <div class="container-narrow">
    <footer> <p>
  &copy; 2023 JiangShuanglong
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  


  <a id="gotop" href="#">
  <span>▲</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


<!-- Mathjax for 3D formula by shuanglong begin -->

<!-- Mathjax for 3D formula by shuanglong end -->

<!-- syntax highlighting -->

  <script>
  marked.setOptions({
    highlight: function (code, lang) {
        return hljs.highlightAuto(code).value;
    }
  });
  function Highlighting(){
    var markdowns = document.getElementsByClassName('markdown');
    for(var i=0;i<markdowns.length;i++){
        if(markdowns[i].innerHTML) markdowns[i].innerHTML =marked(markdowns[i].innerHTML);
    }
  }
  window.addEventListener('DOMContentLoaded', Highlighting, false);
  window.addEventListener('load', Highlighting, false);
  </script>


<!-- mermaid chart -->


</body>
</html>